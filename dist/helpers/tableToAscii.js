// Generated by CoffeeScript 2.3.1
var List, tableToAscii;

List = require('./List');

module.exports = tableToAscii = function(tbl) {
  var el, i, j, k, len, len1, line, out, row, sum, widths, wmatrix;
  tbl = tbl.map(function(row) {
    return row.map(function(el) {
      return el.slice(0, 30);
    });
  });
  if (tbl.length === 1) {
    return out = tbl[0].join(' | ');
  } else {
    wmatrix = tbl.map(function(row) {
      return row.map(function(s) {
        return s.length + 1;
      });
    });
    widths = List.prototype.transpose(wmatrix).map(function(col) {
      return Math.max(...col);
    });
    sum = List.prototype.sum(widths);
    line = '+' + widths.map(function(l) {
      return '-'.repeat(l + 1);
    }).join('+') + '+';
    out = '';
    out += line;
    out += '\n';
    for (j = 0, len = tbl.length; j < len; j++) {
      row = tbl[j];
      for (i = k = 0, len1 = row.length; k < len1; i = ++k) {
        el = row[i];
        el = el.replace('⋮', '…');
        if (out.length > 1024 - (2 * line.length)) {
          break;
        }
        out += "| " + el.padEnd(widths[i]);
      }
      out += '|\n';
    }
    // out += "#{line}\n"
    out += `${line}\n`;
    return out;
  }
};
