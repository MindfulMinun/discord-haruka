// Generated by CoffeeScript 2.3.1
(function() {
  //! ========================================
  //! Purge
  var handler;

  handler = function(msg, match, Haruka) {
    var amount, args;
    args = match.input.tokenize()[1];
    if (!args) {
      return msg.reply(["Please specify the amount of messages to purge.", "You didnâ€™t specify how many messages to delete.", "How many messages do you want me to delete?"].choose());
    }
    amount = parseInt(args);
    if (!((0 <= amount && amount <= 1000))) {
      return msg.reply(["The amount specified must be a positive integer less than 1000.", "The amount of messages to delete must be a number greater than 0 and less than 1000."].choose());
    }
    return msg.channel.fetchMessages({
      limit: amount
    }).then(function(msgs) {
      return msg.channel.bulkDelete(msgs);
    }).then(function() {
      return msg.channel.send([`Purged ${amount} messages.`].choose());
    }).catch(function(err) {
      return msg.channel.send(`Failed to delete messages: \n\`\`\`\n${err}\n\`\`\``);
    });
  };

  module.exports = {
    name: "Purge",
    regex: /^(purge|delete)(\s+|$)/i,
    handler: handler,
    help: {
      short: "-h purge <n>   :: Deletes messages in bulk.",
      long: "```asciidoc\n=== Help for Purge ===\n*Aliases*: purge, delete\n-h purge <amount> :: Deletes specified amount of messages in that channel.\n```"
    }
  };

}).call(this);
