// Generated by CoffeeScript 2.5.1
//! ========================================
//! know-er
var handler, know_er_regex, syllableCounter;

know_er_regex = /([\w]+[aeo]r)/gi;

syllableCounter = function(word) {
  // See https://stackoverflow.com/questions/28384718/regex-understanding-syllable-counter-code
  word = word.toLowerCase();
  if (word.length <= 3) {
    return 1;
  }
  word = word.replace(/(?:[^laeiouy]es|ed|[^laeiouy]e)$/, '');
  word = word.replace(/^y/, '');
  return word.match(/[aeiouy]{1,2}/g).length;
};

handler = function(msg, Haruka) {
  var matches, syllables, word;
  matches = msg.content.match(know_er_regex);
  if (!matches) {
    return false;
  }
  word = matches.last();
  syllables = syllableCounter(word);
  if (syllables < 2) {
    return false;
  }
  return msg.channel.send(`${word.capitalize()}?, I hardly know 'er!`);
};

module.exports = {
  name: "know-er",
  handler: handler
};
